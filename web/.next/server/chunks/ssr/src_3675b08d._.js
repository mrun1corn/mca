module.exports=[90075,a=>{"use strict";function b(a){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT"}).format((a||0)/100)}a.s(["formatBDT",()=>b])},7078,a=>{"use strict";var b=a.i(87924);let c={primary:"bg-blue-600 text-white hover:bg-blue-500",secondary:"bg-white border border-blue-200 text-blue-700 hover:bg-blue-50",ghost:"bg-transparent text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-800",danger:"bg-rose-600 text-white hover:bg-rose-500"};function d({variant:a="primary",className:d="",...e}){return(0,b.jsx)("button",{className:`inline-flex items-center justify-center gap-1.5 rounded-lg px-4 py-2 text-sm font-medium transition disabled:opacity-50 disabled:cursor-not-allowed ${c[a]} ${d}`,...e})}a.s(["default",()=>d])},13411,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(7078),e=a.i(19032),f=a.i(90075);function g({userId:a}){let[g,j]=(0,c.useState)("simple"),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(()=>new Date().toISOString().slice(0,10)),[o,p]=(0,c.useState)("Deposit"),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null);(0,c.useEffect)(()=>{l(""),v(null)},[a]),(0,c.useEffect)(()=>{"pay_due"===g&&(x(!0),B(null),fetch(`${(0,e.getBrowserApiBase)()}/users/${a}/dues`,{credentials:"include"}).then(async a=>{if(!a.ok)throw Error("Failed to load dues");let b=await a.json();t(b),b.length&&!u&&v(b[0]._id)}).catch(a=>B(a?.message||"Failed to load dues")).finally(()=>x(!1)))},[g,a,u]);let K=s.length>0;(0,c.useEffect)(()=>{"pay_due"===g&&K&&!u&&v(s[0]._id)},[g,K,s,u]),(0,c.useEffect)(()=>{"investment_return"===g&&(H(!0),J(null),fetch(`${(0,e.getBrowserApiBase)()}/investments`,{credentials:"include"}).then(async a=>{if(!a.ok)throw Error((await a.json())?.error||"Failed to load investments");let b=await a.json();D(b),b.length&&F(b[0].id)}).catch(a=>J(a?.message||"Failed to load investments")).finally(()=>H(!1)))},[g]),(0,c.useEffect)(()=>{p(a=>"investment_return"===g&&"Deposit"===a?"Investment return":"investment_return"!==g&&"Investment return"===a?"Deposit":a)},[g]);let L=(0,c.useMemo)(()=>s.find(a=>a._id===u),[s,u]),M=(0,c.useMemo)(()=>{if(!L)return 0;let a=new Date(m),b=L.penaltyRule?.graceDays??3,c=L.penaltyRule?.monthlyPenaltyPct??1;for(let d of L.schedule){if("paid"===d.status)continue;let e=(d.totalDuePoisha||0)-(d.paidPoisha||0);if(e<=0)continue;let f=new Date(d.dueDate);f.setDate(f.getDate()+b);let g=e;return q&&a>f&&L.penaltyRule?.enabled&&(g+=Math.floor(d.totalDuePoisha*c/100)),g}return 0},[L,q,m]),N=async()=>{if(a){z(!0),B(null);try{if("investment_return"===g){if(!E)throw Error("Pick an investment to credit the return against.");let a=Number(k);if(!a||!Number.isFinite(a))throw Error("Enter the amount that came back.");let b=await fetch(`${(0,e.getBrowserApiBase)()}/investments/${E}/return`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:a,date:m,note:o})});if(!b.ok)throw Error((await b.json())?.error||"Failed to record investment return");l(""),j("simple"),F(null);return}let b={userId:a,mode:g,date:m,note:o,includePenalty:q},c=Number(k);k?b.amount=Number.isFinite(c)?c:0:b.amountPoisha=M||0,"pay_due"===g&&(b.dueId=u);let d=await fetch(`${(0,e.getBrowserApiBase)()}/deposit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!d.ok)throw Error((await d.json())?.error||"Deposit failed");l("")}catch(a){B(a?.message||"Deposit failed")}finally{z(!1)}}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("section",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 p-4 bg-white/70 dark:bg-slate-900/40 space-y-4",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-2",children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Step 1"}),(0,b.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Choose the intent"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,b.jsx)(i,{title:"Simple deposit",body:"Keeps the balance free for future withdrawals.",active:"simple"===g,onClick:()=>j("simple")}),(0,b.jsx)(i,{title:"Pay down a due",body:K?"Apply this to their repayment schedule.":"No open dues right now.",active:"pay_due"===g,onClick:()=>j("pay_due"),disabled:!K}),(0,b.jsx)(i,{title:"Investment return",body:"Re-add money that just came back from an investment.",active:"investment_return"===g,onClick:()=>j("investment_return")})]}),"pay_due"===g&&(0,b.jsxs)("div",{className:"rounded-2xl border border-blue-100 dark:border-blue-500/30 bg-blue-50/60 dark:bg-blue-500/10 p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Target a due"}),(0,b.jsx)("span",{className:"text-xs text-blue-600 dark:text-blue-200 font-medium bg-blue-100/70 dark:bg-blue-500/20 px-2 py-0.5 rounded-full",children:w?"Loading…":`${s.length} open`})]}),(0,b.jsxs)("select",{className:"input-like",value:u||"",onChange:a=>v(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Select due…"}),s.map(a=>(0,b.jsxs)("option",{value:a._id,children:["Principal ",(0,f.formatBDT)(a.principal)," — ",a.months," mo @ ",a.monthlyRatePct,"%"]},a._id))]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:q,onChange:a=>r(a.target.checked)}),"Add penalty when grace period is over"]}),(0,b.jsxs)("div",{className:"text-xs text-blue-700 dark:text-blue-200 bg-white/60 dark:bg-slate-900/40 rounded-xl px-3 py-2 inline-flex items-center gap-2",children:["Suggested instalment: ",(0,b.jsx)("strong",{children:(0,f.formatBDT)(M)})]})]}),"investment_return"===g&&(0,b.jsxs)("div",{className:"rounded-2xl border border-emerald-200 dark:border-emerald-500/40 bg-emerald-50/60 dark:bg-emerald-500/10 p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Select the investment"}),(0,b.jsx)("span",{className:"text-xs text-emerald-700 dark:text-emerald-200 font-medium bg-white/70 dark:bg-slate-900/40 px-2 py-0.5 rounded-full",children:G?"Loading…":`${C.length} recorded`})]}),(0,b.jsxs)("select",{className:"input-like",value:E||"",onChange:a=>F(a.target.value||null),children:[(0,b.jsx)("option",{value:"",children:"Pick an investment…"}),C.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," · ","completed"===a.status?"Completed":"Active"," (",(0,f.formatBDT)(a.amountPoisha),")"]},a.id))]}),I?(0,b.jsx)("p",{className:"text-sm text-rose-500",children:I}):null,C.length||G?null:(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"No investments recorded yet."})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 p-4 bg-white/80 dark:bg-slate-900/50 space-y-4",children:[(0,b.jsxs)("header",{children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Step 2"}),(0,b.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Fill in the details"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsx)(h,{label:"Amount (BDT)",children:(0,b.jsx)("input",{className:"input-like",type:"number",step:"0.01",placeholder:"0.00",value:k,onChange:a=>l(a.target.value)})}),(0,b.jsx)(h,{label:"Date",children:(0,b.jsx)("input",{className:"input-like",type:"date",value:m,onChange:a=>n(a.target.value)})})]}),(0,b.jsx)(h,{label:"Note",children:(0,b.jsx)("input",{className:"input-like",value:o,onChange:a=>p(a.target.value)})}),A?(0,b.jsx)("p",{className:"text-sm text-rose-500",children:A}):null]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(d.default,{onClick:N,disabled:y,children:y?"Saving…":"Save deposit"})})]})}function h({label:a,children:c}){return(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:a}),c]})}function i({title:a,body:c,active:d,onClick:e,disabled:f}){return(0,b.jsxs)("button",{type:"button",onClick:e,disabled:f,className:`rounded-2xl border p-4 text-left transition disabled:opacity-60 disabled:cursor-not-allowed ${d?"border-blue-400 bg-blue-50 text-blue-700 dark:border-blue-500 dark:bg-blue-500/10 dark:text-blue-200":"border-slate-200 dark:border-slate-700 hover:border-blue-200 hover:bg-blue-50/40 dark:hover:border-blue-500/40 dark:hover:bg-slate-800"}`,children:[(0,b.jsx)("p",{className:"font-semibold",children:a}),(0,b.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:c})]})}a.s(["default",()=>g])},71490,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(13411);function e({users:a}){let[e,f]=(0,c.useState)(a[0]?.id??"");return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:"Who is saving today?"}),(0,b.jsx)("select",{className:"input-like",value:e,onChange:a=>f(a.target.value),children:a.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))}),(0,b.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Need to add someone first? Head to the People page, then swing back here."})]}),e?(0,b.jsx)(d.default,{userId:e}):(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Select a member to unlock the form."})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=src_3675b08d._.js.map