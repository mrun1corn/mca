(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75379,e=>{"use strict";function t(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT"}).format((e||0)/100)}e.s(["formatBDT",()=>t])},10007,e=>{"use strict";var t=e.i(43476),s=e.i(932);let a={primary:"bg-blue-600 text-white hover:bg-blue-500",secondary:"bg-white border border-blue-200 text-blue-700 hover:bg-blue-50",ghost:"bg-transparent text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-800",danger:"bg-rose-600 text-white hover:bg-rose-500"};function r(e){let r,i,l,n,o=(0,s.c)(7);o[0]!==e?({variant:i,className:l,...r}=e,o[0]=e,o[1]=r,o[2]=i,o[3]=l):(r=o[1],i=o[2],l=o[3]);let c=void 0===i?"primary":i,d=void 0===l?"":l,u=`inline-flex items-center justify-center gap-1.5 rounded-lg px-4 py-2 text-sm font-medium transition disabled:opacity-50 disabled:cursor-not-allowed ${a[c]} ${d}`;return o[4]!==r||o[5]!==u?(n=(0,t.jsx)("button",{className:u,...r}),o[4]=r,o[5]=u,o[6]=n):n=o[6],n}e.s(["default",()=>r])},66027,e=>{"use strict";let t;var s=e.i(75555),a=e.i(40143),r=e.i(86491),i=e.i(15823),l=e.i(93803),n=e.i(19273),o=e.i(80166),c=class extends i.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,l.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#a=void 0;#r=void 0;#i=void 0;#l;#n;#s;#t;#o;#c;#d;#u;#h;#m;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#a.addObserver(this),d(this.#a,this.options)?this.#x():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return u(this.#a,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return u(this.#a,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#f(),this.#y(),this.#a.removeObserver(this)}setOptions(e){let t=this.options,s=this.#a;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,n.resolveEnabled)(this.options.enabled,this.#a))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#g(),this.#a.setOptions(this.options),t._defaulted&&!(0,n.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#a,observer:this});let a=this.hasListeners();a&&h(this.#a,s,this.options,t)&&this.#x(),this.updateResult(),a&&(this.#a!==s||(0,n.resolveEnabled)(this.options.enabled,this.#a)!==(0,n.resolveEnabled)(t.enabled,this.#a)||(0,n.resolveStaleTime)(this.options.staleTime,this.#a)!==(0,n.resolveStaleTime)(t.staleTime,this.#a))&&this.#v();let r=this.#j();a&&(this.#a!==s||(0,n.resolveEnabled)(this.options.enabled,this.#a)!==(0,n.resolveEnabled)(t.enabled,this.#a)||r!==this.#m)&&this.#N(r)}getOptimisticResult(e){var t,s;let a=this.#e.getQueryCache().build(this.#e,e),r=this.createResult(a,e);return t=this,s=r,(0,n.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#i=r,this.#n=this.options,this.#l=this.#a.state),r}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#p.add(e)}getCurrentQuery(){return this.#a}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#x({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#x(e){this.#g();let t=this.#a.fetch(this.options,e);return e?.throwOnError||(t=t.catch(n.noop)),t}#v(){this.#f();let e=(0,n.resolveStaleTime)(this.options.staleTime,this.#a);if(n.isServer||this.#i.isStale||!(0,n.isValidTimeout)(e))return;let t=(0,n.timeUntilStale)(this.#i.dataUpdatedAt,e);this.#u=o.timeoutManager.setTimeout(()=>{this.#i.isStale||this.updateResult()},t+1)}#j(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#a):this.options.refetchInterval)??!1}#N(e){this.#y(),this.#m=e,!n.isServer&&!1!==(0,n.resolveEnabled)(this.options.enabled,this.#a)&&(0,n.isValidTimeout)(this.#m)&&0!==this.#m&&(this.#h=o.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||s.focusManager.isFocused())&&this.#x()},this.#m))}#b(){this.#v(),this.#N(this.#j())}#f(){this.#u&&(o.timeoutManager.clearTimeout(this.#u),this.#u=void 0)}#y(){this.#h&&(o.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,a=this.#a,i=this.options,o=this.#i,c=this.#l,u=this.#n,p=e!==a?e.state:this.#r,{state:x}=e,b={...x},f=!1;if(t._optimisticResults){let s=this.hasListeners(),l=!s&&d(e,t),n=s&&h(e,a,t,i);(l||n)&&(b={...b,...(0,r.fetchState)(x.data,e.options)}),"isRestoring"===t._optimisticResults&&(b.fetchStatus="idle")}let{error:y,errorUpdatedAt:g,status:v}=b;s=b.data;let j=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===v){let e;o?.isPlaceholderData&&t.placeholderData===u?.placeholderData?(e=o.data,j=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,void 0!==e&&(v="success",s=(0,n.replaceData)(o?.data,e,t),f=!0)}if(t.select&&void 0!==s&&!j)if(o&&s===c?.data&&t.select===this.#o)s=this.#c;else try{this.#o=t.select,s=t.select(s),s=(0,n.replaceData)(o?.data,s,t),this.#c=s,this.#t=null}catch(e){this.#t=e}this.#t&&(y=this.#t,s=this.#c,g=Date.now(),v="error");let N="fetching"===b.fetchStatus,k="pending"===v,w="error"===v,S=k&&N,D=void 0!==s,R={status:v,fetchStatus:b.fetchStatus,isPending:k,isSuccess:"success"===v,isError:w,isInitialLoading:S,isLoading:S,data:s,dataUpdatedAt:b.dataUpdatedAt,error:y,errorUpdatedAt:g,failureCount:b.fetchFailureCount,failureReason:b.fetchFailureReason,errorUpdateCount:b.errorUpdateCount,isFetched:b.dataUpdateCount>0||b.errorUpdateCount>0,isFetchedAfterMount:b.dataUpdateCount>p.dataUpdateCount||b.errorUpdateCount>p.errorUpdateCount,isFetching:N,isRefetching:N&&!k,isLoadingError:w&&!D,isPaused:"paused"===b.fetchStatus,isPlaceholderData:f,isRefetchError:w&&D,isStale:m(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,n.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===R.status?e.reject(R.error):void 0!==R.data&&e.resolve(R.data)},s=()=>{t(this.#s=R.promise=(0,l.pendingThenable)())},r=this.#s;switch(r.status){case"pending":e.queryHash===a.queryHash&&t(r);break;case"fulfilled":("error"===R.status||R.data!==r.value)&&s();break;case"rejected":("error"!==R.status||R.error!==r.reason)&&s()}}return R}updateResult(){let e=this.#i,t=this.createResult(this.#a,this.options);if(this.#l=this.#a.state,this.#n=this.options,void 0!==this.#l.data&&(this.#d=this.#a),(0,n.shallowEqualObjects)(t,e))return;this.#i=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#p.size)return!0;let a=new Set(s??this.#p);return this.options.throwOnError&&a.add("error"),Object.keys(this.#i).some(t=>this.#i[t]!==e[t]&&a.has(t))};this.#k({listeners:s()})}#g(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#a)return;let t=this.#a;this.#a=e,this.#r=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#k(e){a.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#a,type:"observerResultsUpdated"})})}};function d(e,t){return!1!==(0,n.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&u(e,t,t.refetchOnMount)}function u(e,t,s){if(!1!==(0,n.resolveEnabled)(t.enabled,e)&&"static"!==(0,n.resolveStaleTime)(t.staleTime,e)){let a="function"==typeof s?s(e):s;return"always"===a||!1!==a&&m(e,t)}return!1}function h(e,t,s,a){return(e!==t||!1===(0,n.resolveEnabled)(a.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&m(e,s)}function m(e,t){return!1!==(0,n.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,n.resolveStaleTime)(t.staleTime,e))}e.i(47167);var p=e.i(71645),x=e.i(12598);e.i(43476);var b=p.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),f=p.createContext(!1);f.Provider;var y=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function g(e,t){return function(e,t,s){let r=p.useContext(f),i=p.useContext(b),l=(0,x.useQueryClient)(s),o=l.defaultQueryOptions(e);if(l.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=r?"isRestoring":"optimistic",o.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=o.staleTime;o.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof o.gcTime&&(o.gcTime=Math.max(o.gcTime,1e3))}(o.suspense||o.throwOnError||o.experimental_prefetchInRender)&&!i.isReset()&&(o.retryOnMount=!1),p.useEffect(()=>{i.clearReset()},[i]);let c=!l.getQueryCache().get(o.queryHash),[d]=p.useState(()=>new t(l,o)),u=d.getOptimisticResult(o),h=!r&&!1!==e.subscribed;if(p.useSyncExternalStore(p.useCallback(e=>{let t=h?d.subscribe(a.notifyManager.batchCalls(e)):n.noop;return d.updateResult(),t},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),p.useEffect(()=>{d.setOptions(o)},[o,d]),o?.suspense&&u.isPending)throw y(o,d,i);if((({result:e,errorResetBoundary:t,throwOnError:s,query:a,suspense:r})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(r&&void 0===e.data||(0,n.shouldThrowError)(s,[e.error,a])))({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:l.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if(l.getDefaultOptions().queries?._experimental_afterQuery?.(o,u),o.experimental_prefetchInRender&&!n.isServer&&u.isLoading&&u.isFetching&&!r){let e=c?y(o,d,i):l.getQueryCache().get(o.queryHash)?.promise;e?.catch(n.noop).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?u:d.trackResult(u)}(e,c,t)}e.s(["useQuery",()=>g],66027)},22706,e=>{"use strict";var t=e.i(43476),s=e.i(932);function a(e){let a,r,i,l,n,o,c,d=(0,s.c)(17),{eyebrow:u,title:h,description:m,actions:p}=e;return d[0]!==u?(a=u?(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:u}):null,d[0]=u,d[1]=a):a=d[1],d[2]!==h?(r=(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-slate-900 dark:text-white",children:h}),d[2]=h,d[3]=r):r=d[3],d[4]!==m?(i=m?(0,t.jsx)("p",{className:"text-base text-slate-500 dark:text-slate-400 max-w-3xl",children:m}):null,d[4]=m,d[5]=i):i=d[5],d[6]!==r||d[7]!==i?(l=(0,t.jsxs)("div",{className:"space-y-2",children:[r,i]}),d[6]=r,d[7]=i,d[8]=l):l=d[8],d[9]!==p?(n=p?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:p}):null,d[9]=p,d[10]=n):n=d[10],d[11]!==l||d[12]!==n?(o=(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[l,n]}),d[11]=l,d[12]=n,d[13]=o):o=d[13],d[14]!==a||d[15]!==o?(c=(0,t.jsxs)("div",{className:"mb-6 space-y-3",children:[a,o]}),d[14]=a,d[15]=o,d[16]=c):c=d[16],c}e.s(["default",()=>a])},87246,e=>{"use strict";var t=e.i(43476),s=e.i(932);function a(e){let a,r=(0,s.c)(2),{className:i}=e,l=`h-3 bg-gray-200/80 rounded animate-pulse ${void 0===i?"":i}`;return r[0]!==l?(a=(0,t.jsx)("div",{className:l}),r[0]=l,r[1]=a):a=r[1],a}function r(e){let a,r,l=(0,s.c)(5),{rows:n,className:o}=e,c=void 0===n?4:n,d=`space-y-2 ${void 0===o?"":o}`;return l[0]!==c?(a=Array.from({length:c}).map(i),l[0]=c,l[1]=a):a=l[1],l[2]!==d||l[3]!==a?(r=(0,t.jsx)("div",{className:d,children:a}),l[2]=d,l[3]=a,l[4]=r):r=l[4],r}function i(e,s){return(0,t.jsxs)("div",{className:"bg-white/70 dark:bg-slate-900/40 border border-slate-100 dark:border-slate-800 rounded-xl p-3 space-y-2 animate-pulse",children:[(0,t.jsx)(a,{className:"w-2/3"}),(0,t.jsx)(a,{className:"w-1/3"})]},`skeleton-row-${s}`)}function l(e){let a,r=(0,s.c)(2),{rows:i}=e,l=void 0===i?4:i;return r[0]!==l?(a=(0,t.jsx)("div",{className:"space-y-2",children:Array.from({length:l}).map(n)}),r[0]=l,r[1]=a):a=r[1],a}function n(e,s){return(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-center",children:[(0,t.jsx)(a,{className:"col-span-3 h-3"}),(0,t.jsx)(a,{className:"col-span-4 h-3"}),(0,t.jsx)(a,{className:"col-span-3 h-3"}),(0,t.jsx)(a,{className:"col-span-2 h-3"})]},`skeleton-table-${s}`)}e.s(["SkeletonList",()=>r,"SkeletonTableRows",()=>l])},45953,e=>{"use strict";var t=e.i(43476),s=e.i(932);function a(e){let a,r,i,l,n=(0,s.c)(12),{title:o,description:c,actions:d,children:u,className:h}=e,m=`rounded-2xl border border-[#EADAFB]/70 dark:border-[#2b1f4a] bg-gradient-to-br from-[#FFFFFF] via-[#FCEBFF]/80 to-[#FED2E2]/70 dark:from-[#23143E]/90 dark:via-[#1C1033]/70 dark:to-[#120A23]/70 p-5 shadow-md transition-shadow hover:shadow-xl ${void 0===h?"":h}`;return n[0]!==m?(a=m.trim(),n[0]=m,n[1]=a):a=n[1],n[2]!==d||n[3]!==c||n[4]!==o?(r=(o||c||d)&&(0,t.jsxs)("header",{className:"mb-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[o?(0,t.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900 dark:text-white",children:o}):null,c?(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:c}):null]}),d?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:d}):null]}),n[2]=d,n[3]=c,n[4]=o,n[5]=r):r=n[5],n[6]!==u?(i=(0,t.jsx)("div",{className:"space-y-4",children:u}),n[6]=u,n[7]=i):i=n[7],n[8]!==a||n[9]!==r||n[10]!==i?(l=(0,t.jsxs)("section",{className:a,children:[r,i]}),n[8]=a,n[9]=r,n[10]=i,n[11]=l):l=n[11],l}e.s(["default",()=>a])},87350,e=>{"use strict";var t=e.i(932),s=e.i(71645);function a(e){let a,r,i=(0,t.c)(3);i[0]!==e?(a=()=>{if(!e)return;let t=document.body.style.overflow,s=document.body.style.paddingRight,a=window.innerWidth-document.documentElement.clientWidth;return document.body.style.overflow="hidden",a>0&&(document.body.style.paddingRight=`${a}px`),()=>{document.body.style.overflow=t,document.body.style.paddingRight=s}},r=[e],i[0]=e,i[1]=a,i[2]=r):(a=i[1],r=i[2]),(0,s.useEffect)(a,r)}e.s(["useLockBodyScroll",()=>a])},72328,e=>{"use strict";var t=e.i(71645),s=e.i(22875),a=e.i(96097);function r(){a.hasReducedMotionListener.current||(0,s.initPrefersReducedMotion)();let[e]=(0,t.useState)(a.prefersReducedMotion.current);return e}e.s(["useReducedMotion",()=>r])},94657,e=>{"use strict";var t=e.i(43476),s=e.i(932),a=e.i(71645),r=e.i(10007),i=e.i(9165),l=e.i(75379);function n({userId:e}){let[s,n]=(0,a.useState)("simple"),[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(()=>new Date().toISOString().slice(0,10)),[p,x]=(0,a.useState)("Deposit"),[b,f]=(0,a.useState)(!0),[y,g]=(0,a.useState)([]),[v,j]=(0,a.useState)(null),[N,k]=(0,a.useState)(!1),[w,S]=(0,a.useState)(!1),[D,R]=(0,a.useState)(null),[C,T]=(0,a.useState)([]),[E,F]=(0,a.useState)(null),[I,Q]=(0,a.useState)(!1),[_,O]=(0,a.useState)(null);(0,a.useEffect)(()=>{u(""),j(null)},[e]),(0,a.useEffect)(()=>{"pay_due"===s&&(k(!0),R(null),fetch(`${(0,i.getBrowserApiBase)()}/users/${e}/dues`,{credentials:"include"}).then(async e=>{if(!e.ok)throw Error("Failed to load dues");let t=await e.json();g(t),t.length&&!v&&j(t[0]._id)}).catch(e=>R(e?.message||"Failed to load dues")).finally(()=>k(!1)))},[s,e,v]);let B=y.length>0;(0,a.useEffect)(()=>{"pay_due"===s&&B&&!v&&j(y[0]._id)},[s,B,y,v]),(0,a.useEffect)(()=>{"investment_return"===s&&(Q(!0),O(null),fetch(`${(0,i.getBrowserApiBase)()}/investments`,{credentials:"include"}).then(async e=>{if(!e.ok)throw Error((await e.json())?.error||"Failed to load investments");let t=await e.json();T(t),t.length&&F(t[0].id)}).catch(e=>O(e?.message||"Failed to load investments")).finally(()=>Q(!1)))},[s]),(0,a.useEffect)(()=>{x(e=>"investment_return"===s&&"Deposit"===e?"Investment return":"investment_return"!==s&&"Investment return"===e?"Deposit":e)},[s]);let M=(0,a.useMemo)(()=>y.find(e=>e._id===v),[y,v]),P=(0,a.useMemo)(()=>{if(!M)return 0;let e=new Date(h),t=M.penaltyRule?.graceDays??3,s=M.penaltyRule?.monthlyPenaltyPct??1;for(let a of M.schedule){if("paid"===a.status)continue;let r=(a.totalDuePoisha||0)-(a.paidPoisha||0);if(r<=0)continue;let i=new Date(a.dueDate);i.setDate(i.getDate()+t);let l=r;return b&&e>i&&M.penaltyRule?.enabled&&(l+=Math.floor(a.totalDuePoisha*s/100)),l}return 0},[M,b,h]),A=async()=>{if(e){S(!0),R(null);try{if("investment_return"===s){if(!E)throw Error("Pick an investment to credit the return against.");let e=Number(d);if(!e||!Number.isFinite(e))throw Error("Enter the amount that came back.");let t=await fetch(`${(0,i.getBrowserApiBase)()}/investments/${E}/return`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e,date:h,note:p})});if(!t.ok)throw Error((await t.json())?.error||"Failed to record investment return");u(""),n("simple"),F(null);return}let t={userId:e,mode:s,date:h,note:p,includePenalty:b},a=Number(d);d?t.amount=Number.isFinite(a)?a:0:t.amountPoisha=P||0,"pay_due"===s&&(t.dueId=v);let r=await fetch(`${(0,i.getBrowserApiBase)()}/deposit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error((await r.json())?.error||"Deposit failed");u("")}catch(e){R(e?.message||"Deposit failed")}finally{S(!1)}}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 p-4 bg-white/70 dark:bg-slate-900/40 space-y-4",children:[(0,t.jsxs)("header",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Step 1"}),(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Choose the intent"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,t.jsx)(c,{title:"Simple deposit",body:"Keeps the balance free for future withdrawals.",active:"simple"===s,onClick:()=>n("simple")}),(0,t.jsx)(c,{title:"Pay down a due",body:B?"Apply this to their repayment schedule.":"No open dues right now.",active:"pay_due"===s,onClick:()=>n("pay_due"),disabled:!B}),(0,t.jsx)(c,{title:"Investment return",body:"Re-add money that just came back from an investment.",active:"investment_return"===s,onClick:()=>n("investment_return")})]}),"pay_due"===s&&(0,t.jsxs)("div",{className:"rounded-2xl border border-blue-100 dark:border-blue-500/30 bg-blue-50/60 dark:bg-blue-500/10 p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Target a due"}),(0,t.jsx)("span",{className:"text-xs text-blue-600 dark:text-blue-200 font-medium bg-blue-100/70 dark:bg-blue-500/20 px-2 py-0.5 rounded-full",children:N?"Loading…":`${y.length} open`})]}),(0,t.jsxs)("select",{className:"input-like",value:v||"",onChange:e=>j(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Select due…"}),y.map(e=>(0,t.jsxs)("option",{value:e._id,children:["Principal ",(0,l.formatBDT)(e.principal)," — ",e.months," mo @ ",e.monthlyRatePct,"%"]},e._id))]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:b,onChange:e=>f(e.target.checked)}),"Add penalty when grace period is over"]}),(0,t.jsxs)("div",{className:"text-xs text-blue-700 dark:text-blue-200 bg-white/60 dark:bg-slate-900/40 rounded-xl px-3 py-2 inline-flex items-center gap-2",children:["Suggested instalment: ",(0,t.jsx)("strong",{children:(0,l.formatBDT)(P)})]})]}),"investment_return"===s&&(0,t.jsxs)("div",{className:"rounded-2xl border border-emerald-200 dark:border-emerald-500/40 bg-emerald-50/60 dark:bg-emerald-500/10 p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Select the investment"}),(0,t.jsx)("span",{className:"text-xs text-emerald-700 dark:text-emerald-200 font-medium bg-white/70 dark:bg-slate-900/40 px-2 py-0.5 rounded-full",children:I?"Loading…":`${C.length} recorded`})]}),(0,t.jsxs)("select",{className:"input-like",value:E||"",onChange:e=>F(e.target.value||null),children:[(0,t.jsx)("option",{value:"",children:"Pick an investment…"}),C.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," · ","completed"===e.status?"Completed":"Active"," (",(0,l.formatBDT)(e.amountPoisha),")"]},e.id))]}),_?(0,t.jsx)("p",{className:"text-sm text-rose-500",children:_}):null,C.length||I?null:(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"No investments recorded yet."})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 p-4 bg-white/80 dark:bg-slate-900/50 space-y-4",children:[(0,t.jsxs)("header",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Step 2"}),(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Fill in the details"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsx)(o,{label:"Amount (BDT)",children:(0,t.jsx)("input",{className:"input-like",type:"number",step:"0.01",placeholder:"0.00",value:d,onChange:e=>u(e.target.value)})}),(0,t.jsx)(o,{label:"Date",children:(0,t.jsx)("input",{className:"input-like",type:"date",value:h,onChange:e=>m(e.target.value)})})]}),(0,t.jsx)(o,{label:"Note",children:(0,t.jsx)("input",{className:"input-like",value:p,onChange:e=>x(e.target.value)})}),D?(0,t.jsx)("p",{className:"text-sm text-rose-500",children:D}):null]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(r.default,{onClick:A,disabled:w,children:w?"Saving…":"Save deposit"})})]})}function o(e){let a,r,i=(0,s.c)(5),{label:l,children:n}=e;return i[0]!==l?(a=(0,t.jsx)("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:l}),i[0]=l,i[1]=a):a=i[1],i[2]!==n||i[3]!==a?(r=(0,t.jsxs)("div",{className:"space-y-1",children:[a,n]}),i[2]=n,i[3]=a,i[4]=r):r=i[4],r}function c(e){let a,r,i,l=(0,s.c)(10),{title:n,body:o,active:c,onClick:d,disabled:u}=e,h=`rounded-2xl border p-4 text-left transition disabled:opacity-60 disabled:cursor-not-allowed ${c?"border-blue-400 bg-blue-50 text-blue-700 dark:border-blue-500 dark:bg-blue-500/10 dark:text-blue-200":"border-slate-200 dark:border-slate-700 hover:border-blue-200 hover:bg-blue-50/40 dark:hover:border-blue-500/40 dark:hover:bg-slate-800"}`;return l[0]!==n?(a=(0,t.jsx)("p",{className:"font-semibold",children:n}),l[0]=n,l[1]=a):a=l[1],l[2]!==o?(r=(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:o}),l[2]=o,l[3]=r):r=l[3],l[4]!==u||l[5]!==d||l[6]!==h||l[7]!==a||l[8]!==r?(i=(0,t.jsxs)("button",{type:"button",onClick:d,disabled:u,className:h,children:[a,r]}),l[4]=u,l[5]=d,l[6]=h,l[7]=a,l[8]=r,l[9]=i):i=l[9],i}e.s(["default",()=>n])},55633,54616,e=>{"use strict";var t=e.i(43476),s=e.i(932),a=e.i(71645),r=e.i(14272),i=e.i(40143),l=e.i(15823),n=e.i(19273),o=class extends l.Subscribable{#e;#i=void 0;#w;#S;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#D()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,n.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#w,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,n.hashKey)(t.mutationKey)!==(0,n.hashKey)(this.options.mutationKey)?this.reset():this.#w?.state.status==="pending"&&this.#w.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#w?.removeObserver(this)}onMutationUpdate(e){this.#D(),this.#k(e)}getCurrentResult(){return this.#i}reset(){this.#w?.removeObserver(this),this.#w=void 0,this.#D(),this.#k()}mutate(e,t){return this.#S=t,this.#w?.removeObserver(this),this.#w=this.#e.getMutationCache().build(this.#e,this.options),this.#w.addObserver(this),this.#w.execute(e)}#D(){let e=this.#w?.state??(0,r.getDefaultState)();this.#i={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#k(e){i.notifyManager.batch(()=>{if(this.#S&&this.hasListeners()){let t=this.#i.variables,s=this.#i.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#S.onSuccess?.(e.data,t,s,a),this.#S.onSettled?.(e.data,null,t,s,a)):e?.type==="error"&&(this.#S.onError?.(e.error,t,s,a),this.#S.onSettled?.(void 0,e.error,t,s,a))}this.listeners.forEach(e=>{e(this.#i)})})}},c=e.i(12598);function d(e,t){let s=(0,c.useQueryClient)(t),[r]=a.useState(()=>new o(s,e));a.useEffect(()=>{r.setOptions(e)},[r,e]);let l=a.useSyncExternalStore(a.useCallback(e=>r.subscribe(i.notifyManager.batchCalls(e)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),d=a.useCallback((e,t)=>{r.mutate(e,t).catch(n.noop)},[r]);if(l.error&&(0,n.shouldThrowError)(r.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:d,mutateAsync:l.mutate}}e.s(["useMutation",()=>d],54616);var u=e.i(66027),h=e.i(85723),m=e.i(10007),p=e.i(65673);function x(e){return(0,t.jsx)("option",{value:e.id,children:e.name},e.id)}function b(e){return h.api.post("/investments",e)}function f(e){return h.api.post("/withdraw",e)}async function y(){return(await h.api.get("/users")).data}function g(){return new Date().toISOString().slice(0,10)}function v(){return new Date().toISOString().slice(0,10)}function j(e){let a,r,i=(0,s.c)(5),{label:l,children:n}=e;return i[0]!==l?(a=(0,t.jsx)("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:l}),i[0]=l,i[1]=a):a=i[1],i[2]!==n||i[3]!==a?(r=(0,t.jsxs)("div",{className:"space-y-1",children:[a,n]}),i[2]=n,i[3]=a,i[4]=r):r=i[4],r}function N(e){let a,r,i,l=(0,s.c)(9),{title:n,body:o,active:c,onClick:d}=e,u=`rounded-2xl	border p-4 text-left transition ${c?"border-blue-400 bg-blue-50 text-blue-700 dark:border-blue-500 dark:bg-blue-500/10 dark:text-blue-200":"border-slate-200 text-slate-600 dark:border-slate-700 dark:text-slate-300 hover:border-blue-200 hover:bg-blue-50/40 dark:hover:border-blue-500/40 dark:hover:bg-slate-800"}`;return l[0]!==n?(a=(0,t.jsx)("p",{className:"font-semibold",children:n}),l[0]=n,l[1]=a):a=l[1],l[2]!==o?(r=(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:o}),l[2]=o,l[3]=r):r=l[3],l[4]!==d||l[5]!==u||l[6]!==a||l[7]!==r?(i=(0,t.jsxs)("button",{type:"button",onClick:d,className:u,children:[a,r]}),l[4]=d,l[5]=u,l[6]=a,l[7]=r,l[8]=i):i=l[8],i}let k=(0,a.memo)(function(e){let r,i,l,n,o,k,w,S,D,R,C,T,E,F,I,Q,_,O,B,M,P,A,q,$,L,K,W,U,H,z,V,J,Y,G,X=(0,s.c)(112),{userId:Z}=e,ee=(0,c.useQueryClient)(),{notify:et}=(0,p.useToast)(),es=!Z,[ea,er]=(0,a.useState)("member"),ei=Z?"member":ea,[el,en]=(0,a.useState)(""),[eo,ec]=(0,a.useState)(""),[ed,eu]=(0,a.useState)(v),[eh,em]=(0,a.useState)(3),[ep,ex]=(0,a.useState)(2),[eb,ef]=(0,a.useState)(!0),[ey,eg]=(0,a.useState)(1),[ev,ej]=(0,a.useState)(3),[eN,ek]=(0,a.useState)(""),[ew,eS]=(0,a.useState)(g),[eD,eR]=(0,a.useState)(6),[eC,eT]=(0,a.useState)(3),[eE,eF]=(0,a.useState)(!1);X[0]===Symbol.for("react.memo_cache_sentinel")?(r={queryKey:["users"],queryFn:y},X[0]=r):r=X[0];let eI=(0,u.useQuery)(r);X[1]!==el||X[2]!==Z||X[3]!==eI.data?(i=()=>{Z?en(Z):!el&&eI.data?.length&&en(eI.data[0].id)},l=[eI.data,el,Z],X[1]=el,X[2]=Z,X[3]=eI.data,X[4]=i,X[5]=l):(i=X[4],l=X[5]),(0,a.useEffect)(i,l);e:{if(!eI.data){let e;X[6]===Symbol.for("react.memo_cache_sentinel")?(e=[],X[6]=e):e=X[6],n=e;break e}if("member"===ei){let e;if(X[7]!==el||X[8]!==eI.data){let t;X[10]!==el?(t=e=>e.id!==el,X[10]=el,X[11]=t):t=X[11],e=eI.data.filter(t),X[7]=el,X[8]=eI.data,X[9]=e}else e=X[9];n=e;break e}n=eI.data}let eQ=n;X[12]===Symbol.for("react.memo_cache_sentinel")?(o=[],X[12]=o):o=X[12];let[e_,eO]=(0,a.useState)(o);X[13]!==ei||X[14]!==el?(k=()=>{"member"===ei&&eO(e=>e.filter(e=>e!==el))},w=[ei,el],X[13]=ei,X[14]=el,X[15]=k,X[16]=w):(k=X[15],w=X[16]),(0,a.useEffect)(k,w),X[17]===Symbol.for("react.memo_cache_sentinel")?(S=e=>eO(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),X[17]=S):S=X[17];let eB=S,[,eM]=(0,a.useState)(null);X[18]!==eo||X[19]!==e_?(R=()=>{let e=Number(eo);if(!e||e<=0||!isFinite(e))return void eM(null);let t=e_.join(",");h.api.get("/preview/withdraw-split",{params:{amount:e,excludeIds:t}}).then(e=>eM(e.data)).catch(()=>eM(null))},D=[eo,e_],X[18]=eo,X[19]=e_,X[20]=D,X[21]=R):(D=X[20],R=X[21]),(0,a.useEffect)(R,D),X[22]!==et||X[23]!==ee||X[24]!==el?(C=()=>{el&&ee.invalidateQueries({queryKey:["txs",el]}),ee.invalidateQueries({queryKey:["home"]}),et("Withdraw recorded","success"),ec("")},X[22]=et,X[23]=ee,X[24]=el,X[25]=C):C=X[25],X[26]!==et?(T=()=>et("Withdraw failed","error"),X[26]=et,X[27]=T):T=X[27],X[28]!==C||X[29]!==T?(E={mutationFn:f,onSuccess:C,onError:T},X[28]=C,X[29]=T,X[30]=E):E=X[30];let eP=d(E);X[31]!==et||X[32]!==ee?(F=()=>{ee.invalidateQueries({queryKey:["home"]}),et("Investment recorded","success"),ec(""),ek("")},X[31]=et,X[32]=ee,X[33]=F):F=X[33],X[34]!==et?(I=()=>et("Investment failed","error"),X[34]=et,X[35]=I):I=X[35],X[36]!==F||X[37]!==I?(Q={mutationFn:b,onSuccess:F,onError:I},X[36]=F,X[37]=I,X[38]=Q):Q=X[38];let eA=d(Q);X[39]!==eo||X[40]!==ed||X[41]!==ei||X[42]!==e_||X[43]!==ev||X[44]!==eD||X[45]!==eA||X[46]!==eN||X[47]!==eE||X[48]!==eC||X[49]!==ew||X[50]!==eh||X[51]!==eb||X[52]!==ey||X[53]!==ep||X[54]!==el||X[55]!==eP?(_=()=>{let e=Number(eo);e&&isFinite(e)&&("member"===ei?eP.mutate({takerId:el,amount:e,date:ed,reason:"Withdraw",excludeMemberIds:e_,due:{useDefaultDate:!0,defaultDate:ed,startDate:null,endDate:null,months:eh,monthlyRatePct:ep},penalty:{enabled:eb,monthlyPenaltyPct:ey,graceDays:ev}}):eA.mutate({name:eN||`Investment ${new Date(ew).toLocaleDateString()}`,amount:e,startDate:ew,months:eE?void 0:eD,monthlyRatePct:eE?void 0:eC,openEnded:eE,excludeMemberIds:e_}))},X[39]=eo,X[40]=ed,X[41]=ei,X[42]=e_,X[43]=ev,X[44]=eD,X[45]=eA,X[46]=eN,X[47]=eE,X[48]=eC,X[49]=ew,X[50]=eh,X[51]=eb,X[52]=ey,X[53]=ep,X[54]=el,X[55]=eP,X[56]=_):_=X[56];let eq=_;X[57]!==es||X[58]!==ea?(O=es&&(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 dark:border-slate-800 p-4 bg-white/70 dark:bg-slate-900/40 space-y-4",children:[(0,t.jsx)("header",{className:"flex items-center justify-between flex-wrap gap-2",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Step 1"}),(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Pick the type of outflow"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,t.jsx)(N,{title:"Cash-out to a member",body:"Record a loan or withdrawal and create a repayment plan.",active:"member"===ea,onClick:()=>er("member")}),(0,t.jsx)(N,{title:"Invest the funds",body:"Split contributions and track expected interest from elsewhere.",active:"investment"===ea,onClick:()=>er("investment")})]})]}),X[57]=es,X[58]=ea,X[59]=O):O=X[59],X[60]===Symbol.for("react.memo_cache_sentinel")?(B=(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Who & why"}),X[60]=B):B=X[60];let e$="member"===ei?"Member details":"Investment details";if(X[61]!==e$?(M=(0,t.jsxs)("header",{children:[B,(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:e$})]}),X[61]=e$,X[62]=M):M=X[62],X[63]!==ei||X[64]!==eD||X[65]!==eN||X[66]!==eE||X[67]!==eC||X[68]!==ew||X[69]!==el||X[70]!==Z||X[71]!==eI.data?(P="member"===ei?(0,t.jsx)(j,{label:"Member",children:Z?(0,t.jsx)("div",{className:"text-base font-semibold text-slate-900 dark:text-white",children:eI.data?.find(e=>e.id===Z)?.name||Z}):(0,t.jsx)("select",{className:"input-like",value:el,onChange:e=>en(e.target.value),children:eI.data?.map(x)})}):(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsx)(j,{label:"Investment name",children:(0,t.jsx)("input",{className:"input-like",placeholder:"e.g. Community fridge fund",value:eN,onChange:e=>ek(e.target.value)})}),(0,t.jsx)(j,{label:"Start date",children:(0,t.jsx)("input",{className:"input-like",type:"date",value:ew,onChange:e=>eS(e.target.value)})}),(0,t.jsx)(j,{label:"Months invested",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("input",{className:"input-like",type:"number",min:1,value:eD,onChange:e=>eR(Number(e.target.value)),disabled:eE}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400",children:[(0,t.jsx)("input",{type:"checkbox",checked:eE,onChange:e=>eF(e.target.checked)}),"No end date yet"]})]})}),(0,t.jsx)(j,{label:"Monthly interest %",children:(0,t.jsx)("input",{className:"input-like",type:"number",step:"0.1",value:eC,onChange:e=>eT(Number(e.target.value)),disabled:eE})})]}),X[63]=ei,X[64]=eD,X[65]=eN,X[66]=eE,X[67]=eC,X[68]=ew,X[69]=el,X[70]=Z,X[71]=eI.data,X[72]=P):P=X[72],X[73]!==M||X[74]!==P?(A=(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 dark:border-slate-800 p-4 bg-white/80 dark:bg-slate-900/50 space-y-4",children:[M,P]}),X[73]=M,X[74]=P,X[75]=A):A=X[75],X[76]!==ei||X[77]!==ev||X[78]!==eh||X[79]!==eb||X[80]!==ey||X[81]!==ep?(q="member"===ei&&(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 dark:border-slate-800 p-4 bg-white/70 dark:bg-slate-900/40 space-y-3",children:[(0,t.jsxs)("header",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Repayment plan"}),(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"How will this be paid back?"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,t.jsx)(j,{label:"Months",children:(0,t.jsx)("input",{className:"input-like",type:"number",min:1,value:eh,onChange:e=>em(Number(e.target.value))})}),(0,t.jsx)(j,{label:"Monthly rate %",children:(0,t.jsx)("input",{className:"input-like",type:"number",step:"0.1",value:ep,onChange:e=>ex(Number(e.target.value))})})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:eb,onChange:e=>ef(e.target.checked)}),"Apply penalty when overdue"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,t.jsx)(j,{label:"Penalty % per month",children:(0,t.jsx)("input",{className:"input-like",type:"number",step:"0.1",value:ey,onChange:e=>eg(Number(e.target.value)),disabled:!eb})}),(0,t.jsx)(j,{label:"Grace days",children:(0,t.jsx)("input",{className:"input-like",type:"number",min:0,value:ev,onChange:e=>ej(Number(e.target.value)),disabled:!eb})})]})]}),X[76]=ei,X[77]=ev,X[78]=eh,X[79]=eb,X[80]=ey,X[81]=ep,X[82]=q):q=X[82],X[83]===Symbol.for("react.memo_cache_sentinel")?($=(0,t.jsxs)("header",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Fill in the details"}),(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Amount & date"})]}),X[83]=$):$=X[83],X[84]===Symbol.for("react.memo_cache_sentinel")?(L=e=>ec(e.target.value),X[84]=L):L=X[84],X[85]!==eo?(K=(0,t.jsx)(j,{label:"Amount (BDT)",children:(0,t.jsx)("input",{className:"input-like",type:"number",step:"0.01",placeholder:"0.00",value:eo,onChange:L})}),X[85]=eo,X[86]=K):K=X[86],X[87]===Symbol.for("react.memo_cache_sentinel")?(W=e=>eu(e.target.value),X[87]=W):W=X[87],X[88]!==ed?(U=(0,t.jsx)(j,{label:"Date",children:(0,t.jsx)("input",{className:"input-like",type:"date",value:ed,onChange:W})}),X[88]=ed,X[89]=U):U=X[89],X[90]!==K||X[91]!==U?(H=(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 dark:border-slate-800 p-4 bg-white/80 dark:bg-slate-900/50 space-y-4",children:[$,(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[K,U]})]}),X[90]=K,X[91]=U,X[92]=H):H=X[92],X[93]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsxs)("header",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Exclusions"}),(0,t.jsx)("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Who should skip this split?"})]}),X[93]=z):z=X[93],X[94]!==e_||X[95]!==eQ){let e;X[97]!==e_?(e=e=>(0,t.jsxs)("button",{type:"button",onClick:()=>eB(e.id),className:`rounded-full border px-3 py-1 text-sm ${e_.includes(e.id)?"border-rose-200 bg-rose-50 text-rose-600 dark:border-rose-500/40 dark:bg-rose-500/10 dark:text-rose-200":"border-slate-200 text-slate-600 dark:border-slate-700 dark:text-slate-300"}`,children:[e_.includes(e.id)?"Excluded · ":"",e.name]},e.id),X[97]=e_,X[98]=e):e=X[98],V=eQ.map(e),X[94]=e_,X[95]=eQ,X[96]=V}else V=X[96];X[99]!==V?(J=(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 dark:border-slate-800 p-4 bg-white/70 dark:bg-slate-900/40 space-y-3",children:[z,(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:V})]}),X[99]=V,X[100]=J):J=X[100];let eL=eP.isPending||eA.isPending,eK=eP.isPending||eA.isPending?"Saving…":"member"===ei?"Record withdrawal":"Record investment";return X[101]!==eq||X[102]!==eL||X[103]!==eK?(Y=(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(m.default,{onClick:eq,disabled:eL,children:eK})}),X[101]=eq,X[102]=eL,X[103]=eK,X[104]=Y):Y=X[104],X[105]!==O||X[106]!==A||X[107]!==q||X[108]!==H||X[109]!==J||X[110]!==Y?(G=(0,t.jsxs)("div",{className:"space-y-6",children:[O,A,q,H,J,Y]}),X[105]=O,X[106]=A,X[107]=q,X[108]=H,X[109]=J,X[110]=Y,X[111]=G):G=X[111],G});e.s(["default",0,k],55633)},55378,e=>{"use strict";var t=e.i(43476),s=e.i(932),a=e.i(71645),r=e.i(66027),i=e.i(45953),l=e.i(46932);function n(e){let a,r,i,n,o,c,d,u,h,m,p,x,b=(0,s.c)(28),{label:f,value:y,helper:g,icon:v,onClick:j}=e,N=j?l.motion.button:l.motion.div,k=j?"button":void 0,w=`rounded-2xl border border-white/60 dark:border-[#2b1f4a] bg-gradient-to-br from-[#FDF5FF] via-[#E9A5F1]/60 to-[#C68EFD]/40 dark:from-[#281745] dark:via-[#1f1136] dark:to-[#120926] p-5 shadow-lg shadow-[#C68EFD]/20 transition ${j?"text-left focus:outline-none focus:ring-2 focus:ring-blue-400/40 cursor-pointer":""}`;return b[0]===Symbol.for("react.memo_cache_sentinel")?(a={opacity:0,y:10},r={opacity:1,y:0},i={duration:.2},n={y:-4},b[0]=a,b[1]=r,b[2]=i,b[3]=n):(a=b[0],r=b[1],i=b[2],n=b[3]),b[4]!==j?(o=j?{scale:.98}:void 0,b[4]=j,b[5]=o):o=b[5],b[6]!==v?(c=v?(0,t.jsx)("div",{className:"text-blue-600 dark:text-blue-300",children:v}):null,b[6]=v,b[7]=c):c=b[7],b[8]!==f?(d=(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:f}),b[8]=f,b[9]=d):d=b[9],b[10]!==y?(u=(0,t.jsx)("p",{className:"text-2xl font-semibold text-slate-900 dark:text-white mt-2",children:y}),b[10]=y,b[11]=u):u=b[11],b[12]!==g?(h=g?(0,t.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:g}):null,b[12]=g,b[13]=h):h=b[13],b[14]!==u||b[15]!==h||b[16]!==d?(m=(0,t.jsxs)("div",{children:[d,u,h]}),b[14]=u,b[15]=h,b[16]=d,b[17]=m):m=b[17],b[18]!==m||b[19]!==c?(p=(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[c,m]}),b[18]=m,b[19]=c,b[20]=p):p=b[20],b[21]!==N||b[22]!==j||b[23]!==k||b[24]!==p||b[25]!==w||b[26]!==o?(x=(0,t.jsx)(N,{type:k,onClick:j,className:w,initial:a,animate:r,transition:i,whileHover:n,whileTap:o,children:p}),b[21]=N,b[22]=j,b[23]=k,b[24]=p,b[25]=w,b[26]=o,b[27]=x):x=b[27],x}var o=e.i(75379);function c(e){let a,r,i,n,c,d,u,h,m,p,x,b,f,y=(0,s.c)(27),{member:g,onSelect:v}=e;y[0]!==g.userId||y[1]!==v?(a=()=>{v&&v(g.userId)},y[0]=g.userId,y[1]=v,y[2]=a):a=y[2];let j=a,N=l.motion.button,k=`w-full text-left rounded-2xl border border-white/70 dark:border-[#2b1f4a] bg-gradient-to-br from-[#FDF5FF]/90 via-[#E9A5F1]/60 to-[#C68EFD]/50 dark:from-[#271444]/80 dark:via-[#1f0f37]/60 dark:to-[#140a25]/60 p-4 shadow-lg shadow-[#8F87F1]/15 ${v?"focus:outline-none focus:ring-2 focus:ring-[#C68EFD]/40":""}`;y[3]===Symbol.for("react.memo_cache_sentinel")?(r={y:-4,boxShadow:"0 20px 30px rgba(143,135,241,0.25)"},i={scale:.98},y[3]=r,y[4]=i):(r=y[3],i=y[4]),y[5]===Symbol.for("react.memo_cache_sentinel")?(n={duration:.2,ease:[.16,1,.3,1]},y[5]=n):n=y[5],y[6]!==g.name?(c=(0,t.jsx)("p",{className:"text-base font-semibold text-slate-900 dark:text-white",children:g.name}),y[6]=g.name,y[7]=c):c=y[7];let w=g.lastMonth||0;y[8]!==w?(d=(0,o.formatBDT)(w),y[8]=w,y[9]=d):d=y[9],y[10]!==d?(u=(0,t.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Last month ",d]}),y[10]=d,y[11]=u):u=y[11],y[12]!==c||y[13]!==u?(h=(0,t.jsxs)("div",{children:[c,u]}),y[12]=c,y[13]=u,y[14]=h):h=y[14],y[15]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Balance"}),y[15]=m):m=y[15];let S=g.balance||0;return y[16]!==S?(p=(0,o.formatBDT)(S),y[16]=S,y[17]=p):p=y[17],y[18]!==p?(x=(0,t.jsxs)("div",{className:"text-right",children:[m,(0,t.jsx)("p",{className:"text-sm font-semibold text-emerald-600 dark:text-emerald-300",children:p})]}),y[18]=p,y[19]=x):x=y[19],y[20]!==h||y[21]!==x?(b=(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[h,x]}),y[20]=h,y[21]=x,y[22]=b):b=y[22],y[23]!==j||y[24]!==b||y[25]!==k?(f=(0,t.jsx)(N,{type:"button",onClick:j,className:k,whileHover:r,whileTap:i,transition:n,children:b}),y[23]=j,y[24]=b,y[25]=k,y[26]=f):f=y[26],f}var d=e.i(22706),u=e.i(54616),h=e.i(12598),m=e.i(88653),p=e.i(72328),x=e.i(85723),b=e.i(94657),f=e.i(55633),y=e.i(87246),g=e.i(10007),v=e.i(51514),j=e.i(65673),N=e.i(87350);function k(e){let i,n,c,d,k,C,T,E,F,I,Q,_,O,B,M,P,A,q,$,L,K,W,U,H,z,V,J,Y,G,X,Z,ee,et,es=(0,s.c)(98),{userId:ea,role:er,onClose:ei}=e,el=(0,h.useQueryClient)(),{notify:en}=(0,j.useToast)(),[eo,ec]=(0,a.useState)("ledger"),[ed,eu]=(0,a.useState)(null),[eh,em]=(0,a.useState)("");es[0]!==ed?(i=()=>{ed&&"deposit"===ed.type?em((ed.amount/100).toFixed(2)):em("")},n=[ed],es[0]=ed,es[1]=i,es[2]=n):(i=es[1],n=es[2]),(0,a.useEffect)(i,n),(0,N.useLockBodyScroll)(!0),es[3]!==ea?(c=["txs",ea],d=async()=>(await x.api.get("/transactions",{params:{userId:ea}})).data,es[3]=ea,es[4]=c,es[5]=d):(c=es[4],d=es[5]);let ep=!!ea;es[6]!==c||es[7]!==d||es[8]!==ep?(k={queryKey:c,queryFn:d,enabled:ep},es[6]=c,es[7]=d,es[8]=ep,es[9]=k):k=es[9];let ex=(0,r.useQuery)(k);es[10]!==ea?(C=["dues",ea],T=async()=>(await x.api.get(`/users/${ea}/dues`)).data,es[10]=ea,es[11]=C,es[12]=T):(C=es[11],T=es[12]);let eb=!!ea;es[13]!==C||es[14]!==T||es[15]!==eb?(E={queryKey:C,queryFn:T,enabled:eb},es[13]=C,es[14]=T,es[15]=eb,es[16]=E):E=es[16];let ef=(0,r.useQuery)(E);es[17]!==el||es[18]!==ea?(F=async e=>{let{id:t,body:s}=e;await el.cancelQueries({queryKey:["txs",ea]});let a=el.getQueryData(["txs",ea]);return a&&el.setQueryData(["txs",ea],a.map(e=>e._id===t?{...e,note:s.note??e.note,occurredAt:s.date??e.occurredAt,amount:s.amount?Math.round(100*s.amount):e.amount}:e)),{previous:a}},es[17]=el,es[18]=ea,es[19]=F):F=es[19],es[20]!==en||es[21]!==el||es[22]!==ea?(I=(e,t,s)=>{s?.previous&&el.setQueryData(["txs",ea],s.previous),en("Update failed","error")},es[20]=en,es[21]=el,es[22]=ea,es[23]=I):I=es[23],es[24]!==en?(Q=()=>en("Transaction updated","success"),es[24]=en,es[25]=Q):Q=es[25],es[26]!==el||es[27]!==ea?(_=()=>{el.invalidateQueries({queryKey:["txs",ea]}),eu(null)},es[26]=el,es[27]=ea,es[28]=_):_=es[28],es[29]!==F||es[30]!==I||es[31]!==Q||es[32]!==_?(O={mutationFn:R,onMutate:F,onError:I,onSuccess:Q,onSettled:_},es[29]=F,es[30]=I,es[31]=Q,es[32]=_,es[33]=O):O=es[33];let ey=(0,u.useMutation)(O);es[34]!==el||es[35]!==ea?(B=async e=>{await el.cancelQueries({queryKey:["txs",ea]});let t=el.getQueryData(["txs",ea]);return t&&el.setQueryData(["txs",ea],t.filter(t=>t._id!==e)),{previous:t}},es[34]=el,es[35]=ea,es[36]=B):B=es[36],es[37]!==en||es[38]!==el||es[39]!==ea?(M=(e,t,s)=>{s?.previous&&el.setQueryData(["txs",ea],s.previous),en(e?.response?.data?.error||"Delete failed","error")},es[37]=en,es[38]=el,es[39]=ea,es[40]=M):M=es[40],es[41]!==en?(P=()=>en("Transaction deleted","success"),es[41]=en,es[42]=P):P=es[42],es[43]!==el||es[44]!==ea?(A=()=>el.invalidateQueries({queryKey:["txs",ea]}),es[43]=el,es[44]=ea,es[45]=A):A=es[45],es[46]!==B||es[47]!==M||es[48]!==P||es[49]!==A?(q={mutationFn:D,onMutate:B,onError:M,onSuccess:P,onSettled:A},es[46]=B,es[47]=M,es[48]=P,es[49]=A,es[50]=q):q=es[50];let eg=(0,u.useMutation)(q),ev="user"!==er;es[51]!==eh||es[52]!==ed||es[53]!==ey?($=()=>{if(!ed)return;let e={note:ed.note,date:ed.occurredAt};if("deposit"===ed.type&&eh){let t=Number(eh);Number.isFinite(t)&&(e.amount=t)}ey.mutate({id:ed._id,body:e})},es[51]=eh,es[52]=ed,es[53]=ey,es[54]=$):$=es[54];let ej=$,eN=(0,p.useReducedMotion)();es[55]!==eN?(L=eN?{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}:{initial:{y:"100%"},animate:{y:0,transition:{duration:.3,ease:[.16,1,.3,1]}},exit:{y:"100%",transition:{duration:.22,ease:[.4,0,1,1]}}},es[55]=eN,es[56]=L):L=es[56];let ek=L;es[57]!==eN?(K=eN?{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}:{initial:{scale:.96,opacity:0},animate:{scale:1,opacity:1,transition:{duration:.2,ease:[.16,1,.3,1]}},exit:{scale:.96,opacity:0,transition:{duration:.15,ease:[.4,0,1,1]}}},es[57]=eN,es[58]=K):K=es[58];let ew=K;return es[59]===Symbol.for("react.memo_cache_sentinel")?(W=(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Member"}),(0,t.jsx)("h3",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:"Account overview"})]}),es[59]=W):W=es[59],es[60]===Symbol.for("react.memo_cache_sentinel")?(U=(0,t.jsx)(v.CloseIcon,{}),es[60]=U):U=es[60],es[61]!==ei?(H=(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[W,(0,t.jsx)("button",{type:"button",className:"p-2 rounded-full border border-slate-200 dark:border-slate-700 hover:bg-white/70 dark:hover:bg-slate-900/60",onClick:ei,"aria-label":"Close member drawer",children:U})]}),es[61]=ei,es[62]=H):H=es[62],es[63]!==eo?(z=(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2 border-b border-slate-100 dark:border-slate-800 mb-4 text-sm",children:["ledger","deposit","withdraw","dues"].map(e=>(0,t.jsx)("button",{type:"button",className:`px-3 py-2 rounded-full transition ${eo===e?"bg-blue-600 text-white":"bg-white/70 text-slate-600 dark:bg-slate-900/40 dark:text-slate-300"}`,onClick:()=>ec(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),es[63]=eo,es[64]=z):z=es[64],es[65]!==eo||es[66]!==ea?(V="deposit"===eo?(0,t.jsx)(b.default,{userId:ea}):null,es[65]=eo,es[66]=ea,es[67]=V):V=es[67],es[68]!==eo||es[69]!==ea?(J="withdraw"===eo?(0,t.jsx)(f.default,{userId:ea}):null,es[68]=eo,es[69]=ea,es[70]=J):J=es[70],es[71]!==ev||es[72]!==eg||es[73]!==eo||es[74]!==ex?(Y="ledger"===eo?(0,t.jsxs)("div",{className:"flex flex-col h-[calc(100vh-200px)] pb-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-12 text-xs text-slate-500 px-2",children:[(0,t.jsx)("div",{className:"col-span-3",children:"Date"}),(0,t.jsx)("div",{className:"col-span-4",children:"Details"}),(0,t.jsx)("div",{className:"col-span-3 text-right",children:"Amount"}),(0,t.jsx)("div",{className:"col-span-2 text-right",children:"Actions"})]}),ex.isLoading?(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(y.SkeletonTableRows,{rows:4})}):ex.data?.length?(0,t.jsx)("div",{className:"space-y-1 flex-1 overflow-auto pr-1 mt-2",children:ex.data.map(e=>{let s="deposit"===e.type,a=ev&&s;return(0,t.jsxs)("div",{className:"grid grid-cols-12 items-center px-2 py-2 text-sm border-b border-slate-100 dark:border-slate-900/40",children:[(0,t.jsx)("span",{className:"col-span-3",children:new Date(e.occurredAt).toLocaleDateString("en-BD")}),(0,t.jsx)("span",{className:`col-span-4 ${s?"text-emerald-600":"text-rose-500"}`,children:e.note||(s?"Deposit":"Withdrawal")}),(0,t.jsx)("span",{className:"col-span-3 text-right font-medium",children:(0,o.formatBDT)(e.amount)}),(0,t.jsxs)("span",{className:"col-span-2 flex justify-end gap-2 flex-wrap",children:[(0,t.jsxs)(g.default,{type:"button",variant:"ghost",className:"w-20 justify-center px-3 py-1 text-xs flex items-center gap-1 rounded-full bg-[#8F87F1]/20 text-[#5b3cc4] hover:bg-[#8F87F1]/30 dark:bg-[#4c3c8c]/40 dark:text-white",onClick:()=>eu({...e,occurredAt:new Date(e.occurredAt).toISOString().slice(0,10)}),disabled:!ev,title:ev?"Edit transaction":"View only",children:[(0,t.jsx)(v.PencilIcon,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Edit"})]}),(0,t.jsxs)(g.default,{type:"button",variant:"danger",className:"w-20 justify-center px-3 py-1 text-xs flex items-center gap-1 rounded-full",onClick:()=>{a&&confirm("Delete this transaction?")&&eg.mutate(e._id)},disabled:!a,title:a?"Delete deposit":"Only deposits can be deleted",children:[(0,t.jsx)(v.TrashIcon,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Delete"})]})]})]},e._id)})}):(0,t.jsx)("div",{className:"text-sm text-slate-500 px-2 py-3",children:"No transactions yet."})]}):null,es[71]=ev,es[72]=eg,es[73]=eo,es[74]=ex,es[75]=Y):Y=es[75],es[76]!==ef||es[77]!==eo?(G="dues"===eo?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 text-xs text-slate-500 px-2 mb-2",children:[(0,t.jsx)("span",{children:"Due date"}),(0,t.jsx)("span",{children:"Amount"}),(0,t.jsx)("span",{className:"text-right",children:"Status"})]}),ef.isLoading?(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(y.SkeletonList,{rows:3})}):ef.data?.length?(0,t.jsx)("div",{className:"space-y-2 max-h-72 overflow-auto",children:ef.data.map(S)}):(0,t.jsx)("div",{className:"text-sm text-slate-500 px-2 py-3",children:"No dues scheduled."})]}):null,es[76]=ef,es[77]=eo,es[78]=G):G=es[78],es[79]!==H||es[80]!==z||es[81]!==V||es[82]!==J||es[83]!==Y||es[84]!==G?(X=(0,t.jsxs)("div",{className:"w-full min-h-screen px-4 py-6 sm:px-6 lg:px-10",children:[H,z,V,J,Y,G]}),es[79]=H,es[80]=z,es[81]=V,es[82]=J,es[83]=Y,es[84]=G,es[85]=X):X=es[85],es[86]!==eh||es[87]!==ed||es[88]!==ej||es[89]!==ew||es[90]!==ey?(Z=ed?(0,t.jsx)(l.motion.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>eu(null),children:(0,t.jsxs)(l.motion.div,{className:"w-[calc(100%-2rem)] max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/90 dark:bg-slate-950/85 p-5 shadow-xl",variants:ew,initial:"initial",animate:"animate",exit:"exit",onClick:w,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h4",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"Edit transaction"}),(0,t.jsx)("button",{type:"button",className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>eu(null),children:(0,t.jsx)(v.CloseIcon,{})})]}),(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("label",{className:"space-y-1 block",children:[(0,t.jsx)("span",{className:"text-slate-600 dark:text-slate-300",children:"Date"}),(0,t.jsx)("input",{type:"date",className:"input-like",value:ed.occurredAt,onChange:e=>eu(t=>t?{...t,occurredAt:e.target.value}:t)})]}),(0,t.jsxs)("label",{className:"space-y-1 block",children:[(0,t.jsx)("span",{className:"text-slate-600 dark:text-slate-300",children:"Note"}),(0,t.jsx)("input",{className:"input-like",value:ed.note||"",onChange:e=>eu(t=>t?{...t,note:e.target.value}:t)})]}),(0,t.jsxs)("label",{className:"space-y-1 block",children:[(0,t.jsx)("span",{className:"text-slate-600 dark:text-slate-300",children:"Amount (BDT)"}),(0,t.jsx)("input",{className:"input-like",type:"number",step:"0.01",value:eh,onChange:e=>{em(e.target.value);let t=Number(e.target.value);Number.isFinite(t)&&eu(e=>e?{...e,amount:Math.round(100*t)}:e)},disabled:"deposit"!==ed.type}),"deposit"!==ed.type?(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Withdrawals & investments lock the amount to keep group splits accurate."}):null]})]}),(0,t.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,t.jsx)(g.default,{type:"button",variant:"ghost",onClick:()=>eu(null),children:"Cancel"}),(0,t.jsx)(g.default,{type:"button",disabled:ey.isPending,onClick:ej,children:ey.isPending?"Saving…":"Save changes"})]})]})}):null,es[86]=eh,es[87]=ed,es[88]=ej,es[89]=ew,es[90]=ey,es[91]=Z):Z=es[91],es[92]!==Z?(ee=(0,t.jsx)(m.AnimatePresence,{children:Z}),es[92]=Z,es[93]=ee):ee=es[93],es[94]!==ek||es[95]!==X||es[96]!==ee?(et=(0,t.jsxs)(l.motion.div,{className:"fixed inset-0 z-40 bg-gradient-to-b from-white via-slate-50 to-blue-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 overflow-hidden",variants:ek,initial:"initial",animate:"animate",exit:"exit",children:[X,ee]}),es[94]=ek,es[95]=X,es[96]=ee,es[97]=et):et=es[97],et}function w(e){return e.stopPropagation()}function S(e){return(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800",children:[(0,t.jsxs)("div",{className:"px-3 py-2 text-xs text-slate-500 dark:text-slate-400",children:["Principal: ",(0,o.formatBDT)(e.principal)]}),e.schedule.slice(0,4).map((s,a)=>(0,t.jsxs)("div",{className:"grid grid-cols-3 items-center px-3 py-1 border-t border-slate-100 dark:border-slate-900/40 text-sm",children:[(0,t.jsx)("span",{children:new Date(s.dueDate).toLocaleDateString("en-BD")}),(0,t.jsx)("span",{children:(0,o.formatBDT)(s.totalDuePoisha)}),(0,t.jsx)("span",{className:"text-right capitalize text-xs",children:s.status})]},`${e._id}-${a}`))]},e._id)}function D(e){return x.api.delete(`/transactions/${e}`)}function R(e){let{id:t,body:s}=e;return x.api.patch(`/transactions/${t}`,s)}function C({open:e,totalDeposits:s,totalWithdraws:a,available:c,rows:d,onClose:u}){(0,N.useLockBodyScroll)(e);let h=(0,r.useQuery)({queryKey:["withdrawals","totals"],queryFn:async()=>(await x.api.get("/transactions",{params:{type:"withdraw",limit:20}})).data,enabled:e}),m=(0,r.useQuery)({queryKey:["investments","totals"],queryFn:async()=>(await x.api.get("/investments")).data,enabled:e});if(!e)return null;let b=(0,p.useReducedMotion)();return(0,t.jsx)(l.motion.div,{className:"fixed inset-0 z-40 bg-gradient-to-b from-white via-emerald-50 to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 overflow-y-auto",variants:b?{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}:{initial:{y:"100%"},animate:{y:0,transition:{duration:.32,ease:[.16,1,.3,1]}},exit:{y:"100%",transition:{duration:.22,ease:[.4,0,1,1]}}},initial:"initial",animate:"animate",exit:"exit",children:(0,t.jsxs)("div",{className:"w-full min-h-screen px-4 py-6 sm:px-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Total balance"}),(0,t.jsx)("h2",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:"Collections vs. deductions"})]}),(0,t.jsx)("button",{type:"button",className:"text-sm text-slate-500 hover:text-rose-500",onClick:u,children:"Close"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-4 mb-4",children:[(0,t.jsx)(n,{label:"Collected overall",value:(0,o.formatBDT)(s)}),(0,t.jsx)(n,{label:"Deducted / invested",value:(0,o.formatBDT)(a)}),(0,t.jsx)(n,{label:"Net balance",value:(0,o.formatBDT)(s-a)}),(0,t.jsx)(n,{label:"Available cash",value:(0,o.formatBDT)(c)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,t.jsx)(i.default,{title:"Per-member totals",description:"Lifetime deposits vs. deductions.",children:(0,t.jsx)("div",{className:"overflow-auto max-h-72 pr-1",children:(0,t.jsxs)("table",{className:"min-w-[520px] text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"text-left text-slate-500 dark:text-slate-400",children:[(0,t.jsx)("th",{className:"py-2 pr-3 font-medium",children:"Member"}),(0,t.jsx)("th",{className:"py-2 px-3 font-medium text-right",children:"Deposited"}),(0,t.jsx)("th",{className:"py-2 px-3 font-medium text-right",children:"Deducted"}),(0,t.jsx)("th",{className:"py-2 pl-3 font-medium text-right",children:"Balance"})]})}),(0,t.jsxs)("tbody",{children:[d.map(e=>(0,t.jsxs)("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[(0,t.jsx)("td",{className:"py-2 pr-3 font-medium text-slate-900 dark:text-white",children:e.name}),(0,t.jsx)("td",{className:"py-2 px-3 text-right",children:(0,o.formatBDT)(e.totalDeposits||0)}),(0,t.jsx)("td",{className:"py-2 px-3 text-right",children:(0,o.formatBDT)(e.totalWithdraws||0)}),(0,t.jsx)("td",{className:"py-2 pl-3 text-right font-semibold text-emerald-600 dark:text-emerald-300",children:(0,o.formatBDT)(e.balance||0)})]},e.userId)),!d.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"py-3 text-center text-slate-500",children:"No members yet."})})]})]})})}),(0,t.jsx)(i.default,{title:"Recent withdrawals / investments",description:"Latest 20 records",children:h.isLoading?(0,t.jsx)(y.SkeletonList,{rows:4}):h.data?.length?(0,t.jsx)("div",{className:"space-y-2 max-h-72 overflow-auto pr-1",children:h.data.map(e=>(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 p-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:e.note||"Withdrawal"}),(0,t.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:new Date(e.occurredAt).toLocaleDateString("en-BD")})]}),(0,t.jsx)("p",{className:"text-sm font-semibold text-rose-600 dark:text-rose-300",children:(0,o.formatBDT)(Math.abs(e.amount||0))})]},e._id))}):(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"No withdrawals recorded yet."})})]}),(0,t.jsx)(i.default,{title:"Investments overview",description:"Funds currently out of circulation.",children:m.isLoading?(0,t.jsx)(y.SkeletonList,{rows:3}):m.data?.length?(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:m.data.map(e=>{let s=e.returnedPoisha||0,a=e.amountPoisha+(e.expectedInterestPoisha||0),r=a?Math.min(100,Math.round(s/a*100)):0;return(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 p-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"font-semibold text-slate-900 dark:text-white",children:e.name}),(0,t.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300",children:"completed"===e.status?"Completed":"Active"})]}),(0,t.jsxs)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Principal: ",(0,o.formatBDT)(e.amountPoisha)]}),(0,t.jsxs)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Returned ",(0,o.formatBDT)(s)," of ",(0,o.formatBDT)(a)," (",r,"%)"]}),(0,t.jsx)("div",{className:"w-full h-1.5 rounded-full bg-slate-100 dark:bg-slate-800 overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-emerald-500",style:{width:`${r}%`}})})]},e.id)})}):(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"No investments recorded yet."})})]})})}var T=e.i(18566);function E(){let e=(0,T.useRouter)(),s=new Date().getFullYear(),r=[s,s-1],[i,l]=(0,a.useState)({}),[n,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!1;return async function(){c(!0),u(null);try{let t=await Promise.all(r.map(async e=>{let t=await x.api.get("/reports/yearly-collection",{params:{year:e}});return{year:e,total:t.data?.total??0}}));e||l(t.reduce((e,t)=>({...e,[t.year]:t.total}),{}))}catch(t){e||u(t?.response?.data?.error||"Failed to load yearly totals")}finally{e||c(!1)}}(),()=>{e=!0}},[s]),(0,t.jsxs)("section",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Yearly collection"}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:r.map(s=>{let a=i[s];return(0,t.jsxs)("button",{type:"button",onClick:()=>e.push(`/yearly?year=${s}`),className:"text-left rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/70 p-4 shadow-sm transition hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-400/40",children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Collection year"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-slate-900 dark:text-white mt-1",children:s}),(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-2",children:"number"==typeof a?(0,o.formatBDT)(a):n?"Loading…":"Tap to view details"})]},s)})}),d?(0,t.jsx)("p",{className:"text-sm text-rose-500",children:d}):null]})}function F(e){let l,u,h,p,b,f,y,g,v,j,N,w,S,D,R,F,O,B,M,P,A=(0,s.c)(117),{initialData:q,me:$}=e,L=(0,T.useRouter)(),[K,W]=(0,a.useState)(null),[U,H]=(0,a.useState)(!1);A[0]===Symbol.for("react.memo_cache_sentinel")?(l=["home"],A[0]=l):l=A[0],A[1]!==q?(u={queryKey:l,queryFn:_,initialData:q,staleTime:3e4,gcTime:12e4,refetchOnWindowFocus:!1},A[1]=q,A[2]=u):u=A[2];let z=(0,r.useQuery)(u),V=z.data,J=z.isFetching&&!!z.data;A[3]!==$.id?(h=["dues",$.id],p=async()=>(await x.api.get(`/users/${$.id}/dues`)).data,A[3]=$.id,A[4]=h,A[5]=p):(h=A[4],p=A[5]);let Y="user"===$.role&&!!$.id;A[6]!==h||A[7]!==p||A[8]!==Y?(b={queryKey:h,queryFn:p,enabled:Y,staleTime:3e4,refetchOnWindowFocus:!1},A[6]=h,A[7]=p,A[8]=Y,A[9]=b):b=A[9];let G=(0,r.useQuery)(b);A[10]!==$.id?(f=["txs",$.id,12],y=async()=>(await x.api.get("/transactions",{params:{userId:$.id,limit:20}})).data,A[10]=$.id,A[11]=f,A[12]=y):(f=A[11],y=A[12]);let X="user"===$.role&&!!$.id;A[13]!==f||A[14]!==y||A[15]!==X?(g={queryKey:f,queryFn:y,enabled:X,staleTime:3e4,refetchOnWindowFocus:!1},A[13]=f,A[14]=y,A[15]=X,A[16]=g):g=A[16];let Z=(0,r.useQuery)(g);e:{if("user"!==$.role||!G.data){v=0;break e}let e=null;for(let t of G.data){for(let s of t.schedule){if("paid"===s.status)continue;let t=(s.totalDuePoisha||0)-(s.paidPoisha||0);if(!(t<=0)){e=t;break}}if(e)break}v=e||0}let ee=v;if(!V)return null;if("user"===$.role&&V.cards.length){let e,s,a,r,l,c,u,h,m,p,x,b,f,y=V.cards[0];A[17]!==y||A[18]!==Z.data?(e=Z.data||y.recent||[],A[17]=y,A[18]=Z.data,A[19]=e):e=A[19];let g=e,v=`Hi ${$.name||"there"}, here’s the current picture`;return A[20]!==v?(s=(0,t.jsx)(d.default,{eyebrow:"My savings",title:v,description:"Balance, what you’ve contributed so far, and upcoming instalments if any are still pending."}),A[20]=v,A[21]=s):s=A[21],A[22]!==V.groupBalance?(a=(0,o.formatBDT)(V.groupBalance),A[22]=V.groupBalance,A[23]=a):a=A[23],A[24]!==a?(r=(0,t.jsx)(n,{label:"Savings balance",value:a}),A[24]=a,A[25]=r):r=A[25],A[26]!==V.totalDeposits?(l=(0,o.formatBDT)(V.totalDeposits),A[26]=V.totalDeposits,A[27]=l):l=A[27],A[28]!==l?(c=(0,t.jsx)(n,{label:"Total contributed",value:l}),A[28]=l,A[29]=c):c=A[29],A[30]!==ee?(u=ee>0?(0,t.jsx)(n,{label:"Next payment due",value:(0,o.formatBDT)(ee),helper:"Covers your oldest pending instalment"}):null,A[30]=ee,A[31]=u):u=A[31],A[32]!==r||A[33]!==c||A[34]!==u?(h=(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[r,c,u]}),A[32]=r,A[33]=c,A[34]=u,A[35]=h):h=A[35],A[36]!==J?(m=J?(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Refreshing your dashboard…"}):null,A[36]=J,A[37]=m):m=A[37],A[38]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsxs)("div",{className:"grid grid-cols-12 text-xs text-slate-500 px-2",children:[(0,t.jsx)("div",{className:"col-span-3",children:"Date"}),(0,t.jsx)("div",{className:"col-span-5",children:"Details"}),(0,t.jsx)("div",{className:"col-span-4 text-right",children:"Amount"})]}),A[38]=p):p=A[38],A[39]!==g?(x=g.length?g.map(Q):(0,t.jsx)("div",{className:"text-sm text-slate-500 px-2 py-3",children:"No transactions recorded yet."}),A[39]=g,A[40]=x):x=A[40],A[41]!==x?(b=(0,t.jsxs)(i.default,{title:"Recent activity",description:"Only transactions tied to your name appear here.",children:[p,(0,t.jsx)("div",{className:"max-h-72 overflow-auto divide-y divide-slate-100 dark:divide-slate-800",children:x})]}),A[41]=x,A[42]=b):b=A[42],A[43]!==s||A[44]!==h||A[45]!==m||A[46]!==b?(f=(0,t.jsxs)("div",{className:"space-y-6",children:[s,h,m,b]}),A[43]=s,A[44]=h,A[45]=m,A[46]=b,A[47]=f):f=A[47],f}t:{let e,t,s,a,r,i,l,n,c;if(!V){let e;A[48]===Symbol.for("react.memo_cache_sentinel")?(e=[],A[48]=e):e=A[48],j=e;break t}if(A[49]!==V.groupBalance?(e=(0,o.formatBDT)(V.groupBalance),A[49]=V.groupBalance,A[50]=e):e=A[50],A[51]===Symbol.for("react.memo_cache_sentinel")?(t=()=>H(!0),A[51]=t):t=A[51],A[52]!==e?(s={label:"Total balance",value:e,helper:"Tap to compare deposits vs. deductions",onClick:t},A[52]=e,A[53]=s):s=A[53],A[54]!==V.groupBalance?(a=(0,o.formatBDT)(V.groupBalance),A[54]=V.groupBalance,A[55]=a):a=A[55],A[56]!==L?(r=()=>L.push("/balances"),A[56]=L,A[57]=r):r=A[57],A[58]!==a||A[59]!==r?(i={label:"Available cash",value:a,helper:"See every member’s balance",onClick:r},A[58]=a,A[59]=r,A[60]=i):i=A[60],A[61]!==V.membersCount?(l={label:"Active members",value:V.membersCount,helper:"Counting only active profiles"},A[61]=V.membersCount,A[62]=l):l=A[62],A[63]!==V.arrearsCount?(n={label:"Open dues",value:V.arrearsCount,helper:"Members behind on instalments"},A[63]=V.arrearsCount,A[64]=n):n=A[64],A[65]!==V.investments||A[66]!==V.totalDeposits||A[67]!==s||A[68]!==i||A[69]!==l||A[70]!==n){let e,t,a,r,d,u,h;c=[s,i,l,n],A[72]!==V.investments?(e=V.investments||{principal:0,expectedInterest:0},A[72]=V.investments,A[73]=e):e=A[73];let m=e;A[74]!==m.principal?(t=(0,o.formatBDT)(m.principal),A[74]=m.principal,A[75]=t):t=A[75],A[76]!==t?(a={label:"Invested funds",value:t,helper:"Currently out earning returns"},A[76]=t,A[77]=a):a=A[77],A[78]!==m.expectedInterest?(r=(0,o.formatBDT)(m.expectedInterest),A[78]=m.expectedInterest,A[79]=r):r=A[79],A[80]!==r?(d={label:"Expected interest",value:r},A[80]=r,A[81]=d):d=A[81],A[82]!==V.totalDeposits?(u=(0,o.formatBDT)(V.totalDeposits),A[82]=V.totalDeposits,A[83]=u):u=A[83],A[84]!==u?(h={label:"Total collected",value:u},A[84]=u,A[85]=h):h=A[85],c.push(a,d,h),A[65]=V.investments,A[66]=V.totalDeposits,A[67]=s,A[68]=i,A[69]=l,A[70]=n,A[71]=c}else c=A[71];j=c}let et=j;if(A[86]!==et?(N=(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-4",children:et.map(I)}),A[86]=et,A[87]=N):N=A[87],A[88]!==$.role?(w="user"!==$.role?(0,t.jsx)(E,{}):null,A[88]=$.role,A[89]=w):w=A[89],A[90]!==J?(S=J?(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Refreshing data…"}):null,A[90]=J,A[91]=S):S=A[91],A[92]!==V.cards){let e;A[94]===Symbol.for("react.memo_cache_sentinel")?(e=e=>(0,t.jsx)(c,{member:e,onSelect:e=>W(e)},e.userId),A[94]=e):e=A[94],D=V.cards.map(e),A[92]=V.cards,A[93]=D}else D=A[93];return A[95]!==D?(R=(0,t.jsx)(i.default,{title:"Members at a glance",description:"Open any member to record deposits, withdrawals, or review their ledger.",children:(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-3",children:D})}),A[95]=D,A[96]=R):R=A[96],A[97]!==K||A[98]!==$.role?(F=K?(0,t.jsx)(k,{userId:K,role:$.role,onClose:()=>W(null)}):null,A[97]=K,A[98]=$.role,A[99]=F):F=A[99],A[100]!==F?(O=(0,t.jsx)(m.AnimatePresence,{children:F}),A[100]=F,A[101]=O):O=A[101],A[102]!==V.cards||A[103]!==V.groupBalance||A[104]!==V.totalDeposits||A[105]!==V.totalWithdraws||A[106]!==U?(B=U?(0,t.jsx)(C,{open:U,totalDeposits:V.totalDeposits,totalWithdraws:V.totalWithdraws,available:V.groupBalance,rows:V.cards,onClose:()=>H(!1)}):null,A[102]=V.cards,A[103]=V.groupBalance,A[104]=V.totalDeposits,A[105]=V.totalWithdraws,A[106]=U,A[107]=B):B=A[107],A[108]!==B?(M=(0,t.jsx)(m.AnimatePresence,{children:B}),A[108]=B,A[109]=M):M=A[109],A[110]!==N||A[111]!==w||A[112]!==S||A[113]!==R||A[114]!==O||A[115]!==M?(P=(0,t.jsxs)("div",{className:"space-y-6",children:[N,w,S,R,O,M]}),A[110]=N,A[111]=w,A[112]=S,A[113]=R,A[114]=O,A[115]=M,A[116]=P):P=A[116],P}function I(e){return(0,t.jsx)(n,{label:e.label,value:e.value,helper:e.helper,onClick:e.onClick},String(e.label))}function Q(e){return(0,t.jsxs)("div",{className:"grid grid-cols-12 items-center py-2 px-2 text-sm",children:[(0,t.jsx)("span",{className:"col-span-3",children:new Date(e.occurredAt||e.date).toLocaleDateString("en-BD")}),(0,t.jsx)("span",{className:`col-span-5 ${"deposit"===e.type?"text-emerald-600":"text-rose-600"}`,children:e.note||e.type}),(0,t.jsx)("span",{className:"col-span-4 text-right",children:(0,o.formatBDT)(e.amount)})]},e._id||e.date)}async function _(){return(await x.api.get("/home")).data}e.s(["default",()=>F],55378)}]);